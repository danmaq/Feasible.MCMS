# まくが実践してるFX戦術

## メリットとデメリット

* 安定して収益を出せる
    * 不規則に上下している状態に強い
    * 急激な変動にもやや強い
* トレンド上昇・トレンド下降(跳ね返りのない一方的な動き)に弱い
    * FX口座そのものを分散することである程度対応可能
* 忙しさをコントロールできる
* ハイレバレッジほど利益を得られる
    * ただしゼロカットの仕組みがある海外FX業者を使って追証リスクを回避すべき

## 準備

* __通貨ペア__ を決める(USD/JPYとか)
* __ステップレート__ を決める
    * 小さくするほどハイリスクハイリターン
    * 小さくするほどデイトレになり、大きくするほど長期投資になる
        * FXはデイ〜スイングがベター。長期投資する場合、スワップを十分考慮すること
        * 例えばGBPJPYの場合、¥0.3〜¥0.4くらいが丁度良い忙しさ
* __初期ロット倍率__ を決める
    * 大きくするほどハイリスクハイリターン

## 簡潔な工程一覧

1. 初期ロット倍率で両建て注文する
2. ステップレート分変動するまで待つ
3. 変動したら勝った方を全て決済する
4. 勝った方を初期ロット倍率で注文する
5. 負けた方は負けた倍率の倍プッシュで注文する
6. 2〜6の無限ループ

## シミュレーション

### 0. 仮定

* 本解説用の仮想ドルと日本円の通貨ペア(VTD/JPY=$/¥)
* 開始時のレート $1 = ¥100
* 1ロット 1000単位
* 残高 ¥10,000
* レバレッジ x100
* ステップレート¥1
* 初期ロット倍率x0.01

### 1. 初期ロット倍率で両建て注文する

1. 0.01ロット成行買い注文する (1,000通貨x0.01=10通貨=$10=¥1,000、レバx100なので証拠金¥10+レバ¥990)
2. 0.01ロット成行売り注文する (同上)

* 残高¥10,000(余剰金¥9,980+証拠金¥20)
* 買いポジ$10(=¥1,000、注文時¥1,000)
* 売りポジ$10(=¥1,000、注文時¥1,000)
* 含み益(1000-1000)+(1000-1000)=¥0

### 2. ステップレート分変動するまで待つ

1ドル99円に __下がった__ と仮定する

* 残高¥10,000(余剰金¥9,980+証拠金¥20)
* 買いポジ$10(=¥990、注文時¥1,000)
* 売りポジ$10(=¥990、注文時¥1,000)
* 含み益(990-1000)+(1000-990)=¥0

### 3. 変動したら勝った方を全て決済する

売り注文を全て決済する (1000-990)=__¥+10__

* 残高¥10,010(余剰金¥10,000+証拠金¥10)
* 買いポジ$10(=¥990、注文時¥1,000)
* 含み益(990-1000)=¥-10

### 4. 勝った方を初期ロット倍率で注文する

0.01ロット成行売り注文する ($10=¥990、証拠金¥10)

* 残高¥10,010(余剰金¥9,990+証拠金¥20)
* 買いポジ$10(=¥990、注文時¥1,000)
* 売りポジ$10(=¥990、注文時¥990)
* 含み益(990-1000)+(990-990)=¥-10

### 5. 負けた方は負けた倍率の倍プッシュで注文する

0.02ロット成行買い注文する ($20=¥1980、証拠金¥20)

* 残高¥10,010(余剰金¥9,970+証拠金¥40)
* 買いポジ$10(=¥990、注文時¥1,000)
* 買いポジ$20(=¥1,980、注文時¥1,980)
* 売りポジ$10(=¥990、注文時¥990)
* 含み益(990-1000)+(1980-1980)+(990-990)=¥-10

### 6. 2〜6の無限ループ

### 2. ステップレート分変動するまで待つ

1ドル98円に __下がった__ と仮定する

* 残高¥10,010(余剰金¥9,970+証拠金¥40)
* 買いポジ$10(=¥980、注文時¥1,000)
* 買いポジ$20(=¥1,960、注文時¥1,980)
* 売りポジ$10(=¥980、注文時¥990)
* 含み益(980-1000)+(1960-1980)+(990-980)=¥-40

### 3. 変動したら勝った方を全て決済する

売り注文を全て決済する (990-980)=__¥+10__

* 残高¥10,020(余剰金¥9,990+証拠金¥30)
* 買いポジ$10(=¥980、注文時¥1,000)
* 買いポジ$20(=¥1,960、注文時¥1,980)
* 含み益(980-1000)+(1960-1980)=¥-50

### 4. 勝った方を初期ロット倍率で注文する

0.01ロット成行売り注文する ($10=¥980、証拠金¥10)

* 残高¥10,020(余剰金¥9,980+証拠金¥40)
* 買いポジ$10(=¥980、注文時¥1,000)
* 買いポジ$20(=¥1,960、注文時¥1,980)
* 売りポジ$10(=¥980、注文時¥980)
* 含み益(980-1000)+(1960-1980)+(980-980)=¥-50

### 5. 負けた方は負けた倍率の倍プッシュで注文する

0.04ロット成行買い注文する ($40=¥3,920、証拠金¥39)

* 残高¥10,020(余剰金¥9,941+証拠金¥79)
* 買いポジ$10(=¥980、注文時¥1,000)
* 買いポジ$20(=¥1,960、注文時¥1,980)
* 買いポジ$40(=¥3,920、注文時¥3,920)
* 売りポジ$10(=¥980、注文時¥980)
* 含み益(990-1000)+(1960-1980)+(3920-3920)+(990-990)=¥-10

### 6. 2〜6の無限ループ

### 2. ステップレート分変動するまで待つ

1ドル99円に __上がった__ と仮定する

* 残高¥10,020(余剰金¥9,941+証拠金¥79)
* 買いポジ$10(=¥990、注文時¥1,000)
* 買いポジ$20(=¥1,980、注文時¥1,980)
* 買いポジ$40(=¥3,960、注文時¥3,920)
* 売りポジ$10(=¥990、注文時¥980)
* 含み益(990-1000)+(1980-1980)+(3960-3920)+(980-990)=¥20

### 3. 変動したら勝った方を全て決済する

買い注文を全て決済する (990-1000)+(1980-1980)+(3960-3920)=__¥+20__

* 残高¥10,040(余剰金¥10,030+証拠金¥10)
* 売りポジ$10(=¥990、注文時¥980)
* 含み益(1960-1980)=¥-10

### 4. 勝った方を初期ロット倍率で注文する

0.01ロット成行買い注文する ($10=¥990、証拠金¥10)

* 残高¥10,040(余剰金¥10,020+証拠金¥20)
* 買いポジ$10(=¥990、注文時¥990)
* 売りポジ$10(=¥990、注文時¥980)
* 含み益(990-990)+(980-990)=¥-10

### 5. 負けた方は負けた倍率の倍プッシュで注文する

0.02ロット成行売り注文する ($20=¥1,980、証拠金¥20)

* 残高¥10,040(余剰金¥10,000+証拠金¥40)
* 買いポジ$10(=¥990、注文時¥990)
* 売りポジ$10(=¥990、注文時¥980)
* 売りポジ$20(=¥1,980、注文時¥1,980)
* 含み益(990-990)+(980-990)+(1980-1980)=¥-10

### 6. 2〜6の無限ループ

* ポジションの件数が2〜3件になったら全部決済して中断してもOK。

## 課題

* ローリスクを取ると本当にローリターンになる
    * 3,000円で1ヶ月やって+5,000円程度
* 戦術の構造上、ハイリスクを取ると、自動的にデイトレ傾向になり、忙しくなる
    * ぼっと(EA)化が今後の課題

## ぼっと(EA)化について

* MQL5を用いる。
    * 実質、VisualC++5相当のC++。
        * STL対応がイマイチ。
        * NQuotes を利用してメインロジックを.NETで開発、MQL5での実装を最小化する。
* バックテスト
    * MT4でバックテストやると落ちやすい
        * 独自形式でバックテストを行う
            * 折角だからMongoDBの勉強も兼ねて
        * USDJPY、EURCHF、AUDNZDで10年バックテスト
* バックテストと並列して、少額で実運用もする
* 半年ほど実運用でも実績が取れ次第販売する
    * プライベート投資信託みたいな形にしてもいいかも

### EA開発でつまづいているところ

* スプレッドを計算にふくめると決済結果がマイナスになりうるケースがある
    * 小さすぎるステップを諦めればいけるか？
    * こっちの計算ミスか、メソッドの欠陥かまだわかってない
* 純粋にバックテストを作り込む工数が足りない
    * より緊急かつ重要かつ目先の金にしかならない(しかもあんまり大した額にならない)事項が多すぎて工数を割けない
* NQuotes の知見が少なく、ドキュメントも少ない。
    * 特に日本語ドキュメントは皆無。
    * .NET言語でMQL5開発するには一番有名ぽい。
* MQL5部分の開発もある程度必要で、その部分は必要な学習がかなり多い。
* デバッグがめっちゃめどい